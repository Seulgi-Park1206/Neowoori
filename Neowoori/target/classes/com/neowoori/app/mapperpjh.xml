<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.neowoori.app.IDaopjh">
	
		<!-- 유저 로그인 -->
	<select id="pjhlogin" resultType="Integer"> 
		select count(*) from members where USERID=#{param1} and UPW=#{param2}
	</select>

		<!-- 관리자 로그인 -->
	<select id="pjhadminlogin" resultType="Integer"> 
		select count(*) from admin_account where ADMINID=#{param1} and ADMINPW=#{param2}
	</select>
	
		<!-- 회원가입 -->
	<insert id="pjhsignup">
		insert all into members(UNUM,USERID,UPW,UNAME,UNICK,UYEAR,UBIRTHDAY,UGENDER,UMOBILE,UMAIL,ADDRESS,LATI,LONGI) values (MEMBERS_SEQ.nextval,#{param1},#{param2},#{param3},#{param4},#{param5},#{param6},#{param7},#{param8},#{param9},#{param10},#{param11},#{param12}) into state(UNUM,USERID) values (MEMBERS_SEQ.nextval,#{param1}) select * from dual
	</insert>
	
		<!-- 유저 정보가져오기 -->
	<select id="pjhmemberlist" resultType="com.neowoori.app.BMembers">
		select * from members
	</select>
	
		<!-- 유저상태 정보가져오기 -->
	<select id="pjhStatelist" resultType="com.neowoori.app.BMembersState">
		select s.unum, m.unick, s.lastjoin from state s, members m where s.unum = m.unum
	</select>
	
		<!-- 로그인시 접속시간 업데이트 -->
	<update id="pjhstate">
		update state set LASTJOIN=#{param1} where USERID=#{param2}
	</update>


	
		<!-- 아이디 중복 찾기 -->
	<select id="pjhIdChk" resultType="Integer"> 
		SELECT COUNT(*) FROM members where userid = #{param1} 
	</select>
	
	
	
		<!-- 닉네임 중복 찾기 -->
	<select id="pjhNickChk" resultType="Integer"> 
		SELECT COUNT(*) FROM members where unick = #{param1} 
	</select>
</mapper>